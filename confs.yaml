---
# To init a new machine, run with "-t init"
# To update packages, run with "-t pacman"
# To update bashrc confs, run with "-t bashrc"
# To update SpaceVim conf, run with "-t spacevim"
  - name: "Set up an machine for work"
    hosts: localhost
    vars:
     # Change this to appropriate user
     user: jamfox
    connection: local 
    tasks:

    - name: "sudo pacman -Syu"
      become: true
      pacman:
        update_cache: yes
        upgrade: yes
      tags: 
        - init
        - pacman

    - name: "pacman packages install"
      become: true
      pacman:
        update_cache: yes
        name:
          - vim
          - neovim
          - mlocate
          - wget
          - curl 
          - vlc
          - qbittorrent
          - python
          - make
          - valgrind
          - gdb
          - openssh
          - keychain
          - git
          - ansible 
          - telegram-desktop
          - signal-desktop
          - discord
          - thunderbird
          - firefox
        state: latest
      tags: 
        - init
        - pacman

    - name: "Set up yay for AUR"
      become: true
      shell: |
        git clone https://aur.archlinux.org/yay-git.git
        "chown -R {{ user }}:{{ user }} ./yay-git"
        cd yay-git
        makepkg -si
      tags: 
       - init

    - name: "Copy .bashrc"
      copy:       
        dest: ~/
        src: configs/.bashrc
      tags:
        - bashrc
        - init

    - name: "Copy .bash_profile"
      copy:       
        dest: ~/
        src: configs/.bash_profile
      tags:
        - bashrc
        - init

    - name: "Source .bashrc and .bash_profile"
      shell: |
        source ~/.bashrc
        source ~/.bash_profile
      tags:
        - bashrc
        - init

    - name: "Install SpaceVim"
      shell: curl -sLf https://spacevim.org/install.sh | bash
      tags:
        - init

    - name: "Copy SpaceVim toml config"
      copy: 
        dest: ~/.SpaceVim.d/
        src: configs/.SpaceVim.d/init.toml
      tags:
        - spacevim
        - init

